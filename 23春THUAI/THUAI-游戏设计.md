# THUAI-游戏设计

## 游戏机制

### 最基本的规则&判定胜利的条件

两队对决，每个队伍各有多名AI。每个AI的初始血量为100，被攻击后血量减少，血量为0时死亡，死亡后等待一段时间后即可在地图上随机位置复活。

给定一段时间，时间到后比较双方累计击杀数，多者获胜。

### 地图基本信息

地图为矩形，被划分为若干个方块，每个方块的大小为1*1。方块分为「路面方块」与「障碍物方块」，AI只能在路面方块上移动。地图一定是连通的。

以地图左下角为原点，x轴向右、y轴向上，建立直角坐标系。

AI能够获取全场地图信息，即每个方块是路面方块还是障碍物方块。AI移动的最小单位远小于方块的大小。

### 朝向、视野、射击、移动、听觉

AI有朝向，朝向决定了AI的视野方向，也决定了AI的射击方向：

- AI只能看到前方一定夹角内的事物。
- AI的枪口锁定正前方。

AI能够获取队伍内其他AI的实时位置与朝向。

AI可通过转向来改变朝向。对转向有如下限制：

- 转向的速度是锁死的，该速度约为0.3秒转向180°（即每秒转向600°）。
- 大幅转向时，视野会急剧缩小、[反应速度](#反应速度)会明显变慢，但随后会恢复正常。

转向的可选操作：左转/右转/不转。默认不转。

AI可通过射击来攻击敌人。只要命中，子弹的伤害就是固定的。

射击的可选操作：射击/不射击。默认不射击。

移动的可选操作：

- 前进/后退/不移动。默认不移动。
- 左移/右移/不移动。默认不移动。

若同时设置了前进/后退与左移/右移，总的移动速度是不变的，不会变成$\sqrt{2}$倍。

AI可通过听觉来感知其他AI的存在：

- AI可以听到敌人的射击声。这会使AI知晓敌人的位置。

### 随机复活

AI死亡后，等待一小段时间即可复活。

复活点**不会在敌人的视线范围内**，在此限制下复活于地图上的随机位置。

### 定时炸弹

每个AI都可以安放定时炸弹，一条命只能安放一个定时炸弹，死亡后次数重置。

定时炸弹会在一段时间后爆炸，爆炸范围内的所有AI都会受到伤害。

使用方法：
1. AI可指定自身附近范围内的任一位置设置定时炸弹。
2. 设置炸弹需要一段时间的前摇。前摇期间不能执行其他任何操作。

炸弹在视野范围内时，AI可以看到炸弹与其倒计时。

### 传送阵

可以在「路面方块」上绘制「传送阵」，传送阵的作用是使AI瞬间传送到另一个传送阵。

传送阵由2个**上下相邻**的路面方块组成；**以其中 下方方块 的坐标来标记整个传送阵的坐标**。

传送阵的2个路面方块共有7条边，这些边可以被绘制为「传送阵线段」。传送阵线段决定了传送阵的形状。（全空的不被认为是传送阵）。

AI可以通过一个传送阵来传送到任一**形状相同**的传送阵。AI可以知道每个同形状的传送阵的位置，并且可以选择传送到其中哪个传送阵。

关于绘制与使用传送阵的细节：

AI可感知到以自身所在方块为中心的 $n*n$ 个方块的范围内的传送阵线段，可操作自身所在方块的传送阵线段。

使用传送阵的方法：
1. 移动到所要激活的传送阵的2个路面方块之一。
2. 选择传送阵，查看其能传送到哪些传送阵上。设置传送目标，激活传送阵。
3. 一小段时间后，2个路面方块上的人物与炸弹都会被传送到目标传送阵的2个路面方块上。（操作者之外的AI都不知道传送的目标）。
4. 人物被传送后会有一小段时间的后摇，这段时间内人物无法移动与操作传送阵。

地图上可能会自带一些传送阵线段。

### 反应速度

由于AI的特点，特对反应速度有如下限制：

每次AI执行操作时，该操作不会立即生效，而是会在一小段时间后生效。

对 射击、转向、移动 有反应速度机制。

若没有调用视野信息，则得到「反应速度明显加快」的奖励。

## AI与游戏的交互（API）

每个队伍的多名AI由同一份代码「分别」操控，不能直接共享信息。

具体接口见接口文件（含详细的注释说明）。

## 上帝视角中如何呈现游戏

### 地图（游戏主体）

人物形状为箭头，箭头的朝向与AI的朝向一致。

射击时在画面上显示出弹道，即一条线段（“激光”）。

### 信息面板

- 当前比分
- 各人物数据与当前状态

## 一些不影响游戏机制的细节

具体数值，如：

- 地图大小、每队的AI人数。
- 射击速度、伤害数值。
- 前后摇时长。
- 范围，如视野范围、爆炸范围。

## 仍未确定的游戏机制

- 脚步声：AI可以听到敌人的脚步声。这会使AI知晓敌人在自己的前方或后方（位置向量作差再点乘方向向量）。
- 固定地图 / 更换地图 / 随机生成地图。